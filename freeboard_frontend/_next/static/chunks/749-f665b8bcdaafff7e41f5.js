(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[749],{58749:function(n,e,t){"use strict";t.d(e,{Z:function(){return Vn}});var r=t(809),i=t.n(r),a=t(85893),s=t(92447),o=t(59999),u=t(64121),d=t(46829),c=t(42283),l=t(26265),p=t(27261),f=t(42731);function m(){var n=(0,p.Z)(["\n  width: 17.971888%;\n  height: 52px;\n  font-weight: 500;\n  font-size: 16px;\n  color: whitesmoke;\n  background-color: #1c1c1c;\n  cursor: pointer;\n"]);return m=function(){return n},n}function v(){var n=(0,p.Z)(["\n  display: flex;\n  margin-top: 16px;\n"]);return v=function(){return n},n}function g(){var n=(0,p.Z)(["\n  width: 100%;\n  padding-top: 40px;\n"]);return g=function(){return n},n}function h(){var n=(0,p.Z)(["\n  margin-top: 16px;\n"]);return h=function(){return n},n}function x(){var n=(0,p.Z)(["\n  width: 100%;\n  padding-top: 40px;\n"]);return x=function(){return n},n}function Z(){var n=(0,p.Z)(["\n  width: 100%;\n  height: 52px;\n  margin-top: 16px;\n  padding: 0 16px;\n  font-size: 16px;\n"]);return Z=function(){return n},n}function j(){var n=(0,p.Z)(["\n  width: 100%;\n  padding-top: 40px;\n  display: flex;\n  flex-direction: column;\n"]);return j=function(){return n},n}function b(){var n=(0,p.Z)(["\n  margin: 0 16px;\n"]);return b=function(){return n},n}function w(){var n=(0,p.Z)(["\n  width: 18.367347%;\n  height: 52px;\n  padding: 0 16px;\n  font-size: 16px;\n"]);return w=function(){return n},n}function k(){var n=(0,p.Z)(["\n  width: 100%;\n  margin-top: 16px;\n"]);return k=function(){return n},n}function y(){var n=(0,p.Z)(["\n  width: 100%;\n"]);return y=function(){return n},n}function U(){var n=(0,p.Z)(["\n  width: 59%;\n"]);return U=function(){return n},n}function C(){var n=(0,p.Z)(["\n  width: 100%;\n  height: 252px;\n  margin-top: 16px;\n  border: 1px solid;\n"]);return C=function(){return n},n}function O(){var n=(0,p.Z)(["\n  width: 38%;\n"]);return O=function(){return n},n}function I(){var n=(0,p.Z)(["\n  width: 100%;\n  padding-top: 40px;\n  display: flex;\n  justify-content: space-between;\n"]);return I=function(){return n},n}function P(){var n=(0,p.Z)(["\n  color: red;\n  text-align: center;\n"]);return P=function(){return n},n}function S(){var n=(0,p.Z)(["\n  width: 100%;\n  height: 52px;\n  border: 1px solid;\n  border-bottom: none;\n"]);return S=function(){return n},n}function A(){var n=(0,p.Z)(["\n  width: 100%;\n  height: 320px;\n  margin-top: 16px;\n"]);return A=function(){return n},n}function E(){var n=(0,p.Z)(["\n  width: 100%;\n  padding-top: 40px;\n"]);return E=function(){return n},n}function F(){var n=(0,p.Z)(["\n  font-weight: bold;\n  font-size: 16px;\n"]);return F=function(){return n},n}function _(){var n=(0,p.Z)(["\n  width: 100%;\n  height: 52px;\n  margin-top: 16px;\n"]);return _=function(){return n},n}function D(){var n=(0,p.Z)(["\n  height: 53px;\n  font-weight: bold;\n  font-size: 36px;\n  line-height: 53px;\n"]);return D=function(){return n},n}function L(){var n=(0,p.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: 1200px;\n  padding: 80px 102px;\n  background-color: #ffffff;\n  box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.2);\n"]);return L=function(){return n},n}var M=f.Z.div(L()),$=f.Z.div(D()),N=(f.Z.input(_()),f.Z.div(F())),q=f.Z.div(E()),z=f.Z.div(A()),R=(f.Z.div(S()),f.Z.div(P())),G=f.Z.div(I()),V=f.Z.div(O()),B=(f.Z.div(C()),f.Z.div(U())),W=f.Z.div(y()),X=f.Z.div(k()),H=f.Z.input(w()),J=f.Z.img(b()),K=f.Z.div(j()),Q=f.Z.input(Z()),T=f.Z.div(x()),Y=(f.Z.div(h()),f.Z.div(g())),nn=f.Z.div(v()),en=f.Z.button(m()),tn=t(67294),rn=t(69155);function an(n){return null!==n&&void 0!==n&&n.size?n.size>5242880?(rn.Z.error({content:"\ud30c\uc77c\uc774 \ub108\ubb34 \ud07d\ub2c8\ub2e4.(\uc81c\ud55c: 5MB)"}),!1):!(!n.type.includes("png")&&!n.type.includes("jpeg"))||(rn.Z.error({content:"\ud30c\uc77c \ud655\uc7a5\uc790\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.(png, jpeg\ub9cc \uac00\ub2a5)"}),!1):(rn.Z.error({content:"\ud30c\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),!1)}function sn(){var n=(0,p.Z)(["\n  display: none;\n"]);return sn=function(){return n},n}function on(){var n=(0,p.Z)(["\n  width: 78px;\n  height: 78px;\n  background-color: #bdbdbd;\n  margin-right: 24px;\n  outline: none;\n  border: none;\n  cursor: pointer;\n"]);return on=function(){return n},n}function un(){var n=(0,p.Z)(["\n  width: 78px;\n  height: 78px;\n  margin-right: 24px;\n  cursor: pointer;\n"]);return un=function(){return n},n}var dn=f.Z.img(un()),cn=f.Z.button(on()),ln=f.Z.input(sn());function pn(n){return(0,a.jsxs)(a.Fragment,{children:[n.prevImg[n.index]&&(0,a.jsx)(dn,{onClick:n.onClickUpload,src:"https://storage.googleapis.com/".concat(n.prevImg[n.index])}),!n.prevImg[n.index]&&n.fileUrl&&(0,a.jsx)(dn,{onClick:n.onClickUpload,src:n.fileUrl}),!n.prevImg[n.index]&&!n.fileUrl&&(0,a.jsxs)(cn,{onClick:n.onClickUpload,type:"button",children:[(0,a.jsx)(a.Fragment,{children:"+"}),(0,a.jsx)(a.Fragment,{children:"Upload"})]}),(0,a.jsx)(ln,{type:"file",ref:n.fileRef,onChange:n.onChangeFile})]})}function fn(n){var e=(0,tn.useRef)(null),t=(0,tn.useState)(""),r=t[0],u=t[1];function d(){return(d=(0,s.Z)(i().mark((function e(t){var r,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===(r=t.target.files)||void 0===r?void 0:r[0]){e.next=3;break}return e.abrupt("return");case 3:if(an(a)){e.next=5;break}return e.abrupt("return");case 5:n.prevImg[n.index]&&n.setPrevImg((function(e){var t=(0,o.Z)(e);return t[n.index]=null,t})),(s=new FileReader).readAsDataURL(a),s.onload=function(e){var t;u(null===(t=e.target)||void 0===t?void 0:t.result),n.onChangeFiles(a,n.index)};case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,a.jsx)(pn,{fileRef:e,fileUrl:r,onClickUpload:function(){var n;null===(n=e.current)||void 0===n||n.click()},onChangeFile:function(n){return d.apply(this,arguments)},prevImg:n.prevImg,index:n.index})}function mn(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function vn(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?mn(Object(t),!0).forEach((function(e){(0,l.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):mn(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function gn(){var n=(0,p.Z)(["\n  color: red;\n"]);return gn=function(){return n},n}function hn(){var n=(0,p.Z)(["\n  width: 100%;\n  height: 52px;\n  margin-top: 16px;\n  background-color: white;\n"]);return hn=function(){return n},n}function xn(){var n=(0,p.Z)(["\n  width: 100%;\n  font-size: 16px;\n\n  margin-top: 40px;\n  display: flex;\n  justify-content: left;\n"]);return xn=function(){return n},n}var Zn=f.Z.div(xn()),jn=f.Z.input(hn()),bn=f.Z.div(gn());function wn(n){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Zn,{children:n.inputName}),(0,a.jsx)(jn,vn({type:n.type},n.register)),(0,a.jsx)(bn,{children:n.errorMessage})]})}t(3773);var kn,yn,Un=t(5152);function Cn(n){var e=(0,tn.useState)(!1),t=e[0],r=e[1];return(0,tn.useEffect)((function(){if(n.lat&&n.lng){r(!0);var e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=46a088defe4208f8cfd94b08223db61a&autoload=false&libraries=services",document.head.appendChild(e),e.onload=function(){window.kakao.maps.load((function(){(new window.kakao.maps.services.Geocoder).addressSearch(n.address,(function(e,r){var i,a=r?Number(e[0].y):n.lat,s=r?Number(e[0].x):n.lng;n.setLat(a),n.setLng(s);var o=document.getElementById("map"),u={center:new window.kakao.maps.LatLng(a,s),level:3};if(null===(i=yn)||void 0===i||i.setMap(null),!t){kn=new window.kakao.maps.Map(o,u);var d=new window.kakao.maps.LatLng(a,s);yn=new window.kakao.maps.Marker({position:d})}var c=new window.kakao.maps.LatLng(a,s);yn=new window.kakao.maps.Marker({position:c}),kn.setCenter(c),yn.setMap(kn)}))}))}}}),[n.address]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{id:"map",style:{width:"100%",height:"300px"}})})}var On=t(60007);function In(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function Pn(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?In(Object(t),!0).forEach((function(e){(0,l.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):In(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var Sn=(0,Un.default)((function(){return Promise.all([t.e(774),t.e(937),t.e(127)]).then(t.t.bind(t,71167,23))}),{ssr:!1,loadableGenerated:{webpack:function(){return[71167]},modules:["../src/components/units/market/write/marketWrite.presenter.tsx -> react-quill"]}});function An(n){var e,t,r,i,s,o,u;return(0,a.jsxs)("form",{onSubmit:n.handleSubmit(n.isEdit?n.onClickUpdate:n.onSubmit),children:[n.isOpen&&(0,a.jsx)(rn.Z,{title:"\uc8fc\uc18c\uac80\uc0c9",visible:!0,onOk:function(){return n.onClickAddressSearch(!1)},onCancel:function(){return n.onClickAddressSearch(!1)},children:(0,a.jsx)(On.ZP,{onComplete:n.onCompleteAddressSearch,autoClose:!0})}),(0,a.jsxs)(M,{children:[n.isEdit?(0,a.jsx)($,{children:"\uc0c1\ud488 \uc218\uc815\ud558\uae30"}):(0,a.jsx)($,{children:"\uc0c1\ud488 \ub4f1\ub85d\ud558\uae30"}),(0,a.jsx)(wn,{inputName:"\uc0c1\ud488\uba85",placeholder:"\uc0c1\ud488\uba85\uc744 \uc791\uc131\ud574\uc8fc\uc138\uc694",type:"text",register:Pn({},n.register("name")),errorMessage:null===(e=n.errors.name)||void 0===e?void 0:e.message}),(0,a.jsx)(wn,{inputName:"\ud55c\uc904\uc694\uc57d",placeholder:"\ud310\ub9e4 \uac00\uaca9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",type:"text",register:Pn({},n.register("remarks")),errorMessage:null===(t=n.errors.remarks)||void 0===t?void 0:t.message}),(0,a.jsxs)(q,{children:[(0,a.jsx)(N,{children:"\uc0c1\ud488\uc124\uba85"}),(0,a.jsxs)(z,{children:[(0,a.jsx)(Sn,{onChange:n.onChangeContents,value:n.contents,style:{height:"100%"}}),(0,a.jsx)(R,{children:null===(r=n.errors.contents)||void 0===r?void 0:r.message})]})]}),(0,a.jsx)(wn,{inputName:"\ud310\ub9e4\uac00\uaca9",placeholder:"\ud310\ub9e4 \uac00\uaca9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",type:"text",register:Pn({},n.register("price")),errorMessage:null===(i=n.errors.price)||void 0===i?void 0:i.message}),(0,a.jsx)(wn,{inputName:"\ud0dc\uadf8\uc785\ub825",placeholder:"#\ud0dc\uadf8 #\ud0dc\uadf8 #\ud0dc\uadf8",type:"text",register:Pn({},n.register("tags")),errorMessage:null===(s=n.errors.tags)||void 0===s?void 0:s.message}),(0,a.jsxs)(G,{children:[(0,a.jsxs)(V,{children:[(0,a.jsx)(N,{children:"\uac70\ub798\uc704\uce58"}),(0,a.jsx)(Cn,{lat:n.lat,lng:n.lng,setLat:n.setLat,setLng:n.setLng,address:n.address})]}),(0,a.jsxs)(B,{children:[(0,a.jsxs)(W,{children:[(0,a.jsx)(N,{children:"GPS"}),(0,a.jsxs)(X,{children:[(0,a.jsx)(H,{value:n.lat}),(0,a.jsx)(J,{src:"/images/ic_location_on-24px.svg"}),(0,a.jsx)(H,{value:n.lng})]})]}),(0,a.jsxs)(K,{children:[(0,a.jsx)(N,{children:"\uc8fc\uc18c"}),(0,a.jsx)(Q,{onClick:function(){return n.onClickAddressSearch(!0)},value:n.address,defaultValue:null===(o=n.data)||void 0===o||null===(u=o.fetchUseditem.useditemAddress)||void 0===u?void 0:u.address})]})]})]}),(0,a.jsxs)(T,{children:[(0,a.jsx)(N,{children:"\uc0ac\uc9c4 \ucca8\ubd80"}),new Array(4).fill(1).map((function(e,t){return(0,a.jsx)(fn,{prevImg:n.prevImg,index:t,onChangeFiles:n.onChangeFiles,setPrevImg:n.setPrevImg},"".concat(e,"_").concat(t))}))]}),(0,a.jsxs)(Y,{children:[(0,a.jsx)(N,{children:"\uba54\uc778 \uc0ac\uc9c4 \uc124\uc815"}),(0,a.jsxs)(nn,{children:[(0,a.jsx)(N,{children:"\uc0ac\uc9c4 1"}),(0,a.jsx)(N,{children:"\uc0ac\uc9c4 2"})]})]}),n.isEdit?(0,a.jsx)(en,{type:"submit",children:"\uc218\uc815\ud558\uae30"}):(0,a.jsx)(en,{type:"submit",children:"\ub4f1\ub85d\ud558\uae30"})]})]})}var En=t(28834),Fn=t(22527);function _n(){var n=(0,p.Z)(["\n  mutation updateUseditem(\n    $updateUseditemInput: UpdateUseditemInput!\n    $useditemId: ID!\n  ) {\n    updateUseditem(\n      updateUseditemInput: $updateUseditemInput\n      useditemId: $useditemId\n    ) {\n      _id\n    }\n  }\n"]);return _n=function(){return n},n}function Dn(){var n=(0,p.Z)(["\n  query fetchUseditem($useditemId: ID!) {\n    fetchUseditem(useditemId: $useditemId) {\n      _id\n      name\n      remarks\n      contents\n      price\n      tags\n      images\n      createdAt\n      useditemAddress {\n        address\n        addressDetail\n        lng\n        lat\n      }\n    }\n  }\n"]);return Dn=function(){return n},n}function Ln(){var n=(0,p.Z)(["\n  mutation uploadFile($file: Upload!) {\n    uploadFile(file: $file) {\n      url\n    }\n  }\n"]);return Ln=function(){return n},n}function Mn(){var n=(0,p.Z)(["\n  mutation createUseditem($createUseditemInput: CreateUseditemInput!) {\n    createUseditem(createUseditemInput: $createUseditemInput) {\n      _id\n    }\n  }\n"]);return Mn=function(){return n},n}var $n=(0,Fn.ZP)(Mn()),Nn=(0,Fn.ZP)(Ln()),qn=((0,Fn.ZP)(Dn()),(0,Fn.ZP)(_n())),zn=t(19501),Rn=zn.Ry().shape({name:zn.Z_().required("\uc0c1\ud488\uba85\uc740 \ud544\uc218 \uc785\ub825\uc785\ub2c8\ub2e4."),remarks:zn.Z_().required("\ud55c\uc904\uc694\uc57d\uc740 \ud544\uc218 \uc785\ub825\uc785\ub2c8\ub2e4."),contents:zn.Z_().required("\uc124\uba85\uc740 \ud544\uc218 \uc785\ub825\uc785\ub2c8\ub2e4."),price:zn.Rx().typeError("\uc22b\uc790\uc785\ub825\ud558\uc138\uc694").required("\uac00\uaca9\uc740 \ud544\uc218 \uc785\ub825\uc785\ub2c8\ub2e4."),tags:zn.Z_().required("\ud0dc\uadf8\ub294 \ud544\uc218 \uc785\ub825\uc785\ub2c8\ub2e4.")}),Gn=t(11163);function Vn(n){var e=(0,c.cI)({mode:"onChange",resolver:(0,En.X)(Rn)}),t=e.register,r=e.handleSubmit,l=e.formState,p=e.setValue,f=e.trigger,m=(0,Gn.useRouter)(),v=(0,d.useMutation)($n),g=(0,u.Z)(v,1)[0],h=(0,d.useMutation)(qn),x=(0,u.Z)(h,1)[0],Z=(0,d.useMutation)(Nn),j=(0,u.Z)(Z,1)[0],b=(0,tn.useState)([null,null,null,null]),w=b[0],k=b[1],y=(0,tn.useState)(33.450701),U=y[0],C=y[1],O=(0,tn.useState)(126.570667),I=O[0],P=O[1],S=(0,tn.useState)(""),A=S[0],E=S[1],F=(0,tn.useState)(""),_=F[0],D=F[1],L=(0,tn.useState)(""),M=L[0],$=L[1],N=(0,tn.useState)(!1),q=N[0],z=N[1],R=(0,tn.useState)([]),G=R[0],V=R[1];(0,tn.useEffect)((function(){var e,t,r,i,a,s,o,u,d,c;n.data&&(p("name",null===(e=n.data)||void 0===e?void 0:e.fetchUseditem.name),p("remarks",null===(t=n.data)||void 0===t?void 0:t.fetchUseditem.remarks),p("price",null===(r=n.data)||void 0===r?void 0:r.fetchUseditem.price),p("tags",null===(i=n.data)||void 0===i?void 0:i.fetchUseditem.tags),E(null===(a=n.data)||void 0===a?void 0:a.fetchUseditem.contents),D(null===(s=n.data)||void 0===s||null===(o=s.fetchUseditem.useditemAddress)||void 0===o?void 0:o.address),$(null===(u=n.data)||void 0===u||null===(d=u.fetchUseditem.useditemAddress)||void 0===d?void 0:d.addressDetail),V(null===(c=n.data)||void 0===c?void 0:c.fetchUseditem.images))}),[n.data]),console.log(w);function B(){return(B=(0,s.Z)(i().mark((function n(e){var t,r,a,s;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=w.filter((function(n){return n})).map((function(n){return j({variables:{file:n}})})),n.next=3,Promise.all(t);case 3:return r=n.sent,a=r.map((function(n){return n.data.uploadFile.url})),n.prev=5,n.next=8,g({variables:{createUseditemInput:{name:e.name,remarks:e.remarks,contents:e.contents,price:e.price,tags:e.tags,images:a,useditemAddress:{address:_,addressDetail:M,lat:U,lng:I}}}});case 8:s=n.sent,rn.Z.info({content:"\uac8c\uc2dc\ubb3c\ub4f1\ub85d\uc644\ub8cc!!"}),m.push("/market/".concat(s.data.createUseditem._id)),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),rn.Z.error({content:n.t0.message});case 16:case"end":return n.stop()}}),n,null,[[5,13]])})))).apply(this,arguments)}function W(){return(W=(0,s.Z)(i().mark((function n(e){var t,r,a,s,u,d;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=G.filter((function(n){return n})),r=w.filter((function(n){return n})).map((function(n){return j({variables:{file:n}})})),n.next=4,Promise.all(r);case 4:return a=n.sent,s=a.map((function(n){return n.data.uploadFile.url})),n.prev=6,n.next=9,x({variables:{updateUseditemInput:{name:e.name,remarks:e.remarks,contents:e.contents,price:e.price,tags:e.tags,images:[].concat((0,o.Z)(t),(0,o.Z)(s)),useditemAddress:{address:_,addressDetail:M,lat:U,lng:I}},useditemId:m.query.marketId}});case 9:d=n.sent,console.log(d),rn.Z.info({content:"\uac8c\uc2dc\ubb3c\uc218\uc815\uc644\ub8cc!!"}),m.push("/market/".concat(null===(u=d.data)||void 0===u?void 0:u.updateUseditem._id)),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(6),rn.Z.error({content:n.t0.message});case 18:case"end":return n.stop()}}),n,null,[[6,15]])})))).apply(this,arguments)}return(0,a.jsx)(An,{register:t,handleSubmit:r,onSubmit:function(n){return B.apply(this,arguments)},isActive:l.isValid,errors:l.errors,onChangeFiles:function(n,e){var t=(0,o.Z)(w);t[e]=n,k(t)},onChangeContents:function(n){E(n),p("contents","<p><br></p>"===n?"":n),f("contents")},lat:U,lng:I,setLat:C,setLng:P,address:_,detailAddress:M,onCompleteAddressSearch:function(n){D(n.address),$(n.detailAddress),z(!1)},onClickAddressSearch:function(n){z(n)},isOpen:q,data:n.data,contents:A,onClickUpdate:function(n){return W.apply(this,arguments)},isEdit:n.isEdit,prevImg:G,setPrevImg:V})}}}]);